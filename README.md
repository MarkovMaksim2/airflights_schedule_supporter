# AirFlights Schedule Supporter v2.0.0

Микросервисная архитектура для системы расписания авиаперелетов

## Обзор

Этот проект реализует микросервисную архитектуру для системы расписания авиаперелетов, которая ранее была монолитным приложением. Система была декомпозирована на несколько независимых сервисов, которые взаимодействуют друг с другом через четко определенные API, следуя современным принципам облачной разработки.

## Компоненты архитектуры

### Основные сервисы
- **Airline Service** - Управление информацией об авиакомпаниях и их операциях
- **Airport Service** - Обработка данных об аэропортах и связанных операциях
- **Booking Service** - Управление бронированиями пассажиров и резервированиями
- **Flight Service** - Контроль расписания рейсов, статусов и деталей
- **Passenger Service** - Управление профилями пассажиров и персональной информацией
- **Restricted Zone Service** - Обработка зон ограничения полетов и уведомлений

### Инфраструктурные сервисы
- **Eureka Server** - Сервер обнаружения сервисов для автоматической регистрации и поиска
- **Config Server** - Централизованное управление конфигурацией
- **Gateway Server** - API шлюз для маршрутизации и безопасности

### База данных
- **PostgreSQL** - Реляционная база данных для постоянного хранения данных

## Особенности архитектуры

### Обнаружение сервисов
Все микросервисы автоматически регистрируются в Eureka Server, что позволяет динамически обнаруживать сервисы и осуществлять балансировку нагрузки.

### Управление конфигурацией
Сервисы получают свои конфигурации из централизованного Config Server, что позволяет управлять внешней конфигурацией.

### API шлюз
Все сервисы доступны через Spring Cloud Gateway, который предоставляет:
- Единую точку входа
- Балансировку нагрузки
- Фильтрацию безопасности
- Ограничение скорости запросов
- Преобразование запросов/ответов

### Межсервисное взаимодействие
Сервисы взаимодействуют друг с другом с использованием Feign Clients с интегрированным Circuit Breaker для обеспечения отказоустойчивости.

### Реактивное программирование
- **Booking Service** реализует реактивное программирование с использованием Reactor и R2DBC для неблокирующих операций с базой данных
- **Flight Service** использует реактивное программирование с Reactor и Spring Data JPA для улучшенной масштабируемости

### Хранение данных
- Традиционные сервисы используют Spring Data JPA с PostgreSQL
- Реактивные сервисы используют R2DBC для неблокирующего доступа к базе данных

## Требования

- Docker и Docker Compose
- Java 17+
- Gradle

## Запуск приложения

1. Сборка всех сервисов:
```bash
./gradlew clean build
```

2. Запуск всех сервисов с помощью Docker Compose:
```bash
docker-compose up --build
```

3. Доступ к сервисам:
- **API Gateway**: http://localhost:8080
- **Eureka Dashboard**: http://localhost:8761
- **База данных**: localhost:5432

## Конечные точки сервисов

| Сервис | Путь | Порт |
|--------|------|------|
| Gateway | / | 8080 |
| Eureka | / | 8761 |
| Config Server | / | 9991 |
| Airline Service | /airlines/** | Произвольный |
| Airport Service | /airports/** | Произвольный |
| Booking Service | /bookings/** | Произвольный |
| Flight Service | /flights/** | Произвольный |
| Passenger Service | /passengers/** | Произвольный |
| Restricted Zone Service | /restricted-zones/** | Произвольный |

## Стек технологий

- **Spring Boot 3.x** - Основной фреймворк
- **Spring Cloud** - Оркестрация микросервисов
- **Spring WebFlux** - Реактивный веб-фреймворк
- **Spring Data JPA/R2DBC** - Сохранение данных
- **PostgreSQL** - Реляционная база данных
- **Docker** - Контейнеризация
- **Eureka** - Обнаружение сервисов
- **Spring Cloud Config** - Сервер конфигураций
- **Spring Cloud Gateway** - API шлюз
- **Feign** - Декларативный REST клиент
- **Resilience4j** - Реализация Circuit Breaker

## Структура проекта

```
airflights_schedule_supporter/
├── airline-service/          # Управление авиакомпаниями
├── airport-service/          # Управление аэропортами
├── booking-service/          # Система бронирования и резервирования
├── config-server/            # Сервер конфигураций
├── eureka-server/            # Сервер обнаружения сервисов
├── flight-service/           # Расписание и управление рейсами
├── gateway-server/           # API шлюз
├── passenger-service/        # Управление пассажирами
├── restrictedZone-service/   # Управление зонами ограничения полетов
├── docker-compose.yml        # Оркестрация Docker
└── README.md                 # Этот файл
```

## Основные улучшения по сравнению с монолитом

1. **Масштабируемость** - Каждый сервис может масштабироваться независимо в зависимости от нагрузки
2. **Изоляция сбоев** - Сбои в одном сервисе не выводят из строя всю систему
3. **Разнообразие технологий** - Разные сервисы могут использовать разные технологии по необходимости
4. **Гибкость развертывания** - Сервисы можно развертывать независимо
5. **Автономия команд** - Разные команды могут работать над разными сервисами
6. **Отказоустойчивость** - Circuit Breaker предотвращает каскадные сбои
7. **Производительность** - Реактивное программирование улучшает использование ресурсов

## Мониторинг и наблюдаемость

- Панель Eureka для мониторинга состояния сервисов
- Централизованное логирование (доступно через логи Docker)
- Распределенная трассировка (может быть добавлена с помощью Spring Cloud Sleuth)
- Сбор метрик (доступен через Micrometer)

## Тестирование

Каждый сервис включает:
- Модульные тесты
- Интеграционные тесты
- Контрактные тесты для валидации API

Запуск тестов:
```bash
./gradlew test
```

## Разработка

Для работы с отдельными сервисами:
1. Перейдите в директорию сервиса
2. Запустите сервис напрямую: `./gradlew bootRun`
3. Или импортируйте в вашу IDE как Gradle проект


